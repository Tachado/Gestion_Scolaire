//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "ges_principal.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
Tgprincipal *gprincipal;
//---------------------------------------------------------------------------
__fastcall Tgprincipal::Tgprincipal(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::Button9Click(TObject *Sender)
{
Close();
}
//---------------------------------------------------------------------------


void __fastcall Tgprincipal::Button17Click(TObject *Sender)
{
// enregistrement des classe

	Query3->SQL->Text="INSERT INTO classes(enseignement,init_class,chef_class,nom_class,delai,ens_principal,serie_filiere,scolarite) VALUES('"+esgt->Text+"','"+init_class->Text+"','"+cfc->Text+"','"+clas->Text+"','"+dl_pay->Date.FormatString("yyyy-mm-dd")+"','"+prp->Text+"','"+s_f->Text+"','"+sct->Text+"' ) ";
	Query3->ExecSQL();


	esgt->Text="";
	init_class->Text="";
	cfc->Text="";
	clas->Text="";
	dl_pay->Text="";
	prp->Text="";
	s_f->Text="";
	sct->Text="";

	TabSheet4->OnShow(this);  // pour actualiser la page
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::DBGrid3CellClick(TColumn *Column)
{
if (DBGrid1->SelectedRows->Count>0) {
	AnsiString idpl1="";
	 TDataSet * ligne = DBGrid1 ->DataSource->DataSet;
	 idpl1= ligne ->Fields->Fields[0] -> AsString;
	 k->Text= idpl1  ;

}
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::Button18Click(TObject *Sender)
{
Close();
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::TabSheet4Show(TObject *Sender)
{
Query3->SQL->Text="SELECT * FROM classes Order By id_class ";
	Query3->Open();
	Query3->Active=true;
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::Button20Click(TObject *Sender)
{
Query1->SQL->Text="UPDATE classes SET enseignement='"+ esgt->Text+"',init_class='"+
init_class->Text+"',chef_class='"+cfc->Text+"',nom_class='"+clas->Text+"',ens_principal='"+
prp->Text+"',serie_filiere='"+s_f->Text+"',scolarite='"+sct->Text+"' WHERE id_class='"+k->Text+"'   ";
Query1->ExecSQL();

	esgt->Text="";
	init_class->Text="";
	cfc->Text="";
	clas->Text="";
	dl_pay->Text="";
	prp->Text="";
	s_f->Text="";
	sct->Text="";

	TabSheet4->OnShow(this);  // pour actualiser la page
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::Button19Click(TObject *Sender)
{
if (MessageDlgPos("êtes-vous sure de vouloir supprimer ?", mtConfirmation, mbYesNoCancel, 0, 500, 300, mbYes)== IDYES)
 {
  Query2->SQL->Text=" DELETE FROM classes WHERE id_class='"+k->Text+"' ";
Query1->ExecSQL();
}
		TabSheet4->OnShow(this);  // pour actualiser la page
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::Supprimer1Click(TObject *Sender)
{
   if (MessageDlgPos("êtes-vous sure de vouloir supprimer ?", mtConfirmation, mbYesNoCancel, 0, 500, 300, mbYes)== IDYES)
 {
  Query2->SQL->Text=" DELETE FROM classes WHERE id_class='"+k->Text+"' ";
Query1->ExecSQL();
}
		TabSheet4->OnShow(this);  // pour actualiser la page
}
//---------------------------------------------------------------------------

void __fastcall Tgprincipal::Modifier1Click(TObject *Sender)
{
	AnsiString id1,esgt1,init_class1,cfc1,clas1,prp1,s_f1,sct1;
   if (DBGrid1->SelectedRows->Count>0) {
	 TDataSet * ligne = DBGrid1 ->DataSource->DataSet;
	 id1= ligne ->Fields->FieldByName("id_class")->AsAnsiString;
	 esgt1= ligne ->Fields->FieldByName("enseignement")->AsAnsiString;
	 init_class1 = ligne ->Fields->FieldByName("init_class")->AsAnsiString;
	 cfc1= ligne ->Fields->FieldByName("chef_class")->AsAnsiString;
	 clas1=  ligne ->Fields->FieldByName("nom_class")->AsAnsiString;
	 prp1= ligne ->Fields->FieldByName("ens_principal")->AsAnsiString;
	 s_f1= ligne ->Fields->FieldByName("serie_filiere")->AsAnsiString;
	 sct1= ligne ->Fields->FieldByName("scolarite")->AsAnsiString;





	  esgt->Text=esgt1;
	init_class->Text=init_class1;
	cfc->Text=cfc1;
	clas->Text=clas1;
	prp->Text=prp1;
	s_f->Text=s_f1;
	sct->Text=sct1;

   }
	L1->Query1->SQL->Text="SELECT * FROM classes WHERE id_class='"+id1+"'  ";
   L1->Query1->Open();
   L1->Query1->Active=true;
}
//---------------------------------------------------------------------------

